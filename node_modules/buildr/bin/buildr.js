#!/usr/bin/env node
(function() {
  var argv, buildr, filename, fs, optimist, path;

  fs = require('fs');

  path = require('path');

  buildr = require(__dirname + '/../lib/buildr');

  optimist = require('optimist');

  argv = optimist.options('file', {
    alias: 'f',
    "default": 'buildr.json'
  }).argv;

  filename = path.resolve(argv.file);

  fs.exists(filename, function(exists) {
    if (exists) {
      return fs.readFile(filename, 'utf8', function(err, data) {
        if (err) {
          throw err;
        }
        return buildr.createInstance(JSON.parse(config)).process(function(processingError) {
          if (processingError) {
            throw processingError;
          }
        });
      });
    } else {
      return console.error("Configuration file not found: " + filename);
    }
  });

}).call(this);
